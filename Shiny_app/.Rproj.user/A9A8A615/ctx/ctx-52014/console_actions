{
    "type": [
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2
    ],
    "data": [
        "> ",
        "forecasted_curves_USA_FM_VAR_cov <- readRDS(\"./forecasted_curves_USA_FM_VAR_cov.rds\")",
        "> ",
        "max_h=10",
        "> ",
        "error_MAPE_means_male<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_RMSPE_means_male<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_MAPE_means_female<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_RMSPE_means_female<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "for (i in 1:n_prefectures) {",
        "+ ",
        "  forecasted_pref_male=forecasted_curves_USA_FM_VAR_cov[[i]][1:n_age,]",
        "+ ",
        "  forecasted_pref_female=forecasted_curves_USA_FM_VAR_cov[[i]][(n_age+1):(2*n_age),]",
        "+ ",
        "  True_pop_male=t(all_male[(n_year*i-(max_h-1)):(n_year*i),])",
        "+ ",
        "  True_pop_female=t(all_female[(n_year*i-(max_h-1)):(n_year*i),])",
        "+ ",
        "  for (j in 1:max_h) {",
        "+ ",
        "    error_MAPE_means_male[j,i]<-mape(forecast=forecasted_pref_male[,j], true=True_pop_male[,j])",
        "+ ",
        "    error_RMSPE_means_male[j,i]<-rmspe(forecast=forecasted_pref_male[,j], true=True_pop_male[,j])",
        "+ ",
        "    error_MAPE_means_female[j,i]<-mape(forecast=forecasted_pref_female[,j], true=True_pop_female[,j])",
        "+ ",
        "    error_RMSPE_means_female[j,i]<-rmspe(forecast=forecasted_pref_female[,j], true=True_pop_female[,j])",
        "+ ",
        "    ",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "}",
        "Error in mape(forecast = forecasted_pref_male[, j], true = True_pop_male[,  : \n  could not find function \"mape\"\n",
        "> ",
        "# saveRDS(forecasted_curves_triangular_means_rolling ,\"forecasted_curves_triangular_means_rolling_USA_new.rds\")",
        "> ",
        "##############################################################################################################",
        "> ",
        "#Compute the error based on FM-ANOVA approach, with the forecasts obtained in the rolling window approach",
        "> ",
        "##############################################################################################################",
        "> ",
        "source(\"./Rcodes_paper/forecast_errors.R\")",
        "> ",
        "forecasted_curves_USA_FM_VAR_cov <- readRDS(\"./forecasted_curves_USA_FM_VAR_cov.rds\")",
        "> ",
        "max_h=10",
        "> ",
        "error_MAPE_means_male<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_RMSPE_means_male<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_MAPE_means_female<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_RMSPE_means_female<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "for (i in 1:n_prefectures) {",
        "+ ",
        "  forecasted_pref_male=forecasted_curves_USA_FM_VAR_cov[[i]][1:n_age,]",
        "+ ",
        "  forecasted_pref_female=forecasted_curves_USA_FM_VAR_cov[[i]][(n_age+1):(2*n_age),]",
        "+ ",
        "  True_pop_male=t(all_male[(n_year*i-(max_h-1)):(n_year*i),])",
        "+ ",
        "  True_pop_female=t(all_female[(n_year*i-(max_h-1)):(n_year*i),])",
        "+ ",
        "  for (j in 1:max_h) {",
        "+ ",
        "    error_MAPE_means_male[j,i]<-mape(forecast=forecasted_pref_male[,j], true=True_pop_male[,j])",
        "+ ",
        "    error_RMSPE_means_male[j,i]<-rmspe(forecast=forecasted_pref_male[,j], true=True_pop_male[,j])",
        "+ ",
        "    error_MAPE_means_female[j,i]<-mape(forecast=forecasted_pref_female[,j], true=True_pop_female[,j])",
        "+ ",
        "    error_RMSPE_means_female[j,i]<-rmspe(forecast=forecasted_pref_female[,j], true=True_pop_female[,j])",
        "+ ",
        "    ",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "}",
        "> ",
        "All_errors_mean_rolling<-list(error_MAPE_means_male,error_MAPE_means_female,",
        "+ ",
        "                              error_RMSPE_means_male,error_RMSPE_means_female)",
        "> ",
        "saveRDS(All_errors_mean_rolling,\"All_errors_table_USA_FM_cov_VAR.rds\")",
        "> ",
        "# saveRDS(All_errors_mean_rolling,\"All_errors_table_USA_FM_cov_VAR.rds\")",
        "> ",
        "Errors_mean_basedmeans_rolling<-matrix(0,nrow=n_prefectures,ncol=length(All_errors_mean_rolling))",
        "> ",
        "Errors_sd_basedmeans_rolling<-matrix(0,nrow=n_prefectures,ncol=length(All_errors_mean_rolling))",
        "> ",
        "for (i in 1:length(All_errors_mean_rolling)) {",
        "+ ",
        "  error=All_errors_mean_rolling[[i]]",
        "+ ",
        "  Errors_mean_basedmeans_rolling[,i]=apply( error,2,mean)",
        "+ ",
        "  Errors_sd_basedmeans_rolling[,i]=apply( error,2,sd)",
        "+ ",
        "}",
        "> ",
        "colnames(Errors_mean_basedmeans_rolling)<-c(\"MAPE_male\",\"MAPE_female\",\"RMSPE_male\",\"RMSPE_female\")",
        "> ",
        "colnames(Errors_sd_basedmeans_rolling)<-c(\"MAPE_male\",\"MAPE_female\",\"RMSPE_male\",\"RMSPE_female\")",
        "> ",
        "rownames(Errors_mean_basedmeans_rolling)<-names_states",
        "> ",
        "rownames(Errors_sd_basedmeans_rolling)<-names_states",
        "> ",
        "saveRDS(Errors_mean_basedmeans_rolling,\"Errors_mean_rolling_VAR_FM_cov_USA.rds\")",
        "> ",
        "# saveRDS(Errors_mean_basedmeans_rolling,\"Errors_mean_rolling_VAR_FM_cov_USA.rds\")",
        "> ",
        "dir.l<-\"~/My Drive/Fall 2023/STAT 397/PhD project 4/Revisions from JCGS/Plots2paper/\"",
        "> ",
        "savepdf <- function(file, width=16, height=10)",
        "+ ",
        "{",
        "+ ",
        "  fname <- paste(dir.l,file,\".pdf\",sep=\"\")",
        "+ ",
        "  pdf(fname, width=width/2.54, height=height/2.54,",
        "+ ",
        "      pointsize=10)",
        "+ ",
        "  par(mgp=c(2.2,0.45,0), tcl=-0.4, mar=c(3.3,3.6,1.1,1.1))",
        "+ ",
        "}",
        "> ",
        "Errors_mean_basedmeans_rolling_USA_Static <- readRDS(\"~/My Drive/Fall 2023/STAT 397/PhD project 4/Revisions from JCGS/Rcodes/Errors_mean_basedmeans_rolling_USA_Static.rds\")",
        "> ",
        "us.basedmeans_cov <- readRDS(\"./Errors_mean_basedmeans_rolling_USA_Static.rds\")",
        "> ",
        "us.basedmeans_cov <- readRDS(\"./Errors_mean_basedmeans_rolling_USA_Static.rds\")",
        "> ",
        "# some plots",
        "> ",
        "savepdf(\"USA_MAPE_FM_cov\") ",
        "> ",
        "par(mfrow=c(1,2))",
        "> ",
        "boxplot(us.basedmeans_cov[,2],Errors_mean_basedmeans_rolling[,2],main=\"MAPE Female\",col=c(\"blue\",\"red\"))",
        "> ",
        "boxplot(us.basedmeans_cov[,1],Errors_mean_basedmeans_rolling[,1],main=\"MAPE Male\",col=c(\"blue\",\"red\"))",
        "> ",
        "dev.off()",
        "pdf \n  4 \n",
        "> ",
        "savepdf(\"USA_RMPSE_FM_cov\") ",
        "> ",
        "par(mfrow=c(1,2))",
        "> ",
        "boxplot(us.basedmeans[,4],Errors_mean_basedmeans_rolling[,4],main=\"RMPSE Female\",col=c(\"blue\",\"red\"))",
        "Error in boxplot(us.basedmeans[, 4], Errors_mean_basedmeans_rolling[,  : \n  object 'us.basedmeans' not found\n",
        "> ",
        "boxplot(us.basedmeans[,3],Errors_mean_basedmeans_rolling[,3],main=\"RMPSE Male\",col=c(\"blue\",\"red\"))",
        "Error in boxplot(us.basedmeans[, 3], Errors_mean_basedmeans_rolling[,  : \n  object 'us.basedmeans' not found\n",
        "> ",
        "# some plots",
        "> ",
        "savepdf(\"USA_MAPE_FM_cov\") ",
        "> ",
        "par(mfrow=c(1,2))",
        "> ",
        "boxplot(us.basedmeans_cov[,2],Errors_mean_basedmeans_rolling[,2],main=\"MAPE Female\",col=c(\"blue\",\"red\"))",
        "> ",
        "boxplot(us.basedmeans_cov[,1],Errors_mean_basedmeans_rolling[,1],main=\"MAPE Male\",col=c(\"blue\",\"red\"))",
        "> ",
        "dev.off()",
        "pdf \n  4 \n",
        "> ",
        "savepdf(\"USA_RMPSE_FM_cov\") ",
        "> ",
        "par(mfrow=c(1,2))",
        "> ",
        "boxplot(us.basedmeans_cov[,4],Errors_mean_basedmeans_rolling[,4],main=\"RMPSE Female\",col=c(\"blue\",\"red\"))",
        "> ",
        "boxplot(us.basedmeans_cov[,3],Errors_mean_basedmeans_rolling[,3],main=\"RMPSE Male\",col=c(\"blue\",\"red\"))",
        "> ",
        "dev.off()",
        "pdf \n  4 \n",
        "> ",
        "forecasted_curves_USA_FM_VAR_cov <- readRDS(\"./forecasted_curves_USA_FM_VAR_cov.rds\")",
        "> ",
        "max_h=10",
        "> ",
        "error_MAPE_means_male<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_RMSPE_means_male<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_MAPE_means_female<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "error_RMSPE_means_female<-matrix(0,nrow=max_h,ncol = n_prefectures)",
        "> ",
        "for (i in 1:n_prefectures) {",
        "+ ",
        "  forecasted_pref_male=forecasted_curves_USA_FM_VAR_cov[[i]][1:n_age,]",
        "+ ",
        "  forecasted_pref_female=forecasted_curves_USA_FM_VAR_cov[[i]][(n_age+1):(2*n_age),]",
        "+ ",
        "  True_pop_male=t(all_male[(n_year*i-(max_h-1)):(n_year*i),])",
        "+ ",
        "  True_pop_female=t(all_female[(n_year*i-(max_h-1)):(n_year*i),])",
        "+ ",
        "  for (j in 1:max_h) {",
        "+ ",
        "    error_MAPE_means_male[j,i]<-mape(forecast=forecasted_pref_male[,j], true=True_pop_male[,j])",
        "+ ",
        "    error_RMSPE_means_male[j,i]<-rmspe(forecast=forecasted_pref_male[,j], true=True_pop_male[,j])",
        "+ ",
        "    error_MAPE_means_female[j,i]<-mape(forecast=forecasted_pref_female[,j], true=True_pop_female[,j])",
        "+ ",
        "    error_RMSPE_means_female[j,i]<-rmspe(forecast=forecasted_pref_female[,j], true=True_pop_female[,j])",
        "+ ",
        "    ",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "}",
        "> ",
        "All_errors_mean_rolling<-list(error_MAPE_means_male,error_MAPE_means_female,",
        "+ ",
        "                              error_RMSPE_means_male,error_RMSPE_means_female)",
        "> ",
        "# saveRDS(All_errors_mean_rolling,\"All_errors_table_USA_FM_cov_VAR.rds\")",
        "> ",
        "Errors_mean_basedmeans_rolling<-matrix(0,nrow=n_prefectures,ncol=length(All_errors_mean_rolling))",
        "> ",
        "Errors_sd_basedmeans_rolling<-matrix(0,nrow=n_prefectures,ncol=length(All_errors_mean_rolling))",
        "> ",
        "for (i in 1:length(All_errors_mean_rolling)) {",
        "+ ",
        "  error=All_errors_mean_rolling[[i]]",
        "+ ",
        "  Errors_mean_basedmeans_rolling[,i]=apply( error,2,mean)",
        "+ ",
        "  Errors_sd_basedmeans_rolling[,i]=apply( error,2,sd)",
        "+ ",
        "}",
        "> ",
        "colnames(Errors_mean_basedmeans_rolling)<-c(\"MAPE_male\",\"MAPE_female\",\"RMSPE_male\",\"RMSPE_female\")",
        "> ",
        "colnames(Errors_sd_basedmeans_rolling)<-c(\"MAPE_male\",\"MAPE_female\",\"RMSPE_male\",\"RMSPE_female\")",
        "> ",
        "rownames(Errors_mean_basedmeans_rolling)<-names_states",
        "> ",
        "rownames(Errors_sd_basedmeans_rolling)<-names_states",
        "> ",
        "View(Errors_mean_basedmeans_rolling)",
        "> ",
        "View(us.basedmeans_cov)",
        "> ",
        "par(mfrow=c(1,2))",
        "> ",
        "boxplot(us.basedmeans_cov[,2],Errors_mean_basedmeans_rolling[,2],main=\"MAPE Female\",col=c(\"blue\",\"red\"))",
        "> ",
        "boxplot(us.basedmeans_cov[,1],Errors_mean_basedmeans_rolling[,1],main=\"MAPE Male\",col=c(\"blue\",\"red\"))",
        "\nRestarting R session...\n\n"
    ]
}